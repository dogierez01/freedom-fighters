<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Freedom Fighters - All-in-One</title>
    
    <script>
        function startApp() {
            var splash = document.getElementById('splash-screen');
            if(splash) {
                splash.style.opacity = '0';
                setTimeout(function() { splash.style.display = 'none'; }, 500);
            }
        }
    </script>

    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }

        /* SPLASH SCREEN - LOGO WITH NEON YELLOW RING */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease-out; }
        #splash-img { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; margin-bottom: 30px; border: 8px solid #ccff00; box-shadow: 0 0 20px #ccff00, 0 0 40px #ccff00; }
        #start-btn { padding: 15px 60px; font-size: 22px; font-weight: 900; color: white; background: linear-gradient(135deg, #2f9e44, #2ecc71); border: none; border-radius: 50px; cursor: pointer; text-transform: uppercase; }

        /* HEADER AREA */
        #header-area { position: fixed; top: 0; left: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 2000; display: flex; flex-direction: column; align-items: center; padding-bottom: 10px; }
        #app-title { color: #fff; font-size: 16px; font-weight: 900; margin: 10px 0; letter-spacing: 1px; text-transform: uppercase; }

        /* NAVIGATION TABS */
        .toggle-container { display: flex; background: #1e1e1e; border-radius: 30px; padding: 4px; border: 1px solid #333; margin-bottom: 5px;}
        .toggle-btn { padding: 8px 24px; border-radius: 25px; border: none; font-size: 13px; font-weight: bold; cursor: pointer; color: #888; background: transparent; }
        .toggle-btn.active { color: #fff; background: #007AFF; }

        /* AUDIO PLAYER UI */
        #audio-controls { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 5px; }
        #now-playing { color: #4dabf7; font-size: 12px; margin-bottom: 5px; font-weight: bold; }
        .player-row { display: flex; align-items: center; justify-content: center; gap: 10px; width: 95%; max-width: 600px; }
        #player { flex-grow: 1; height: 45px; }
        #btn-snail { min-width: 60px; height: 45px; background: #111; border: 2px solid #ff0033; border-radius: 10px; font-size: 25px; cursor: pointer; }
        #btn-snail.active { border-color: #39ff14; box-shadow: 0 0 10px #39ff14; }

        /* MAIN CONTENT SLOTS */
        #content-listen { padding: 20px; padding-top: 175px; max-width: 650px; margin: 0 auto; display: block; }
        #content-quiz { display: none; padding: 20px; padding-top: 175px; max-width: 650px; margin: 0 auto; }

        /* STUDY CARDS */
        .search { width: 100%; padding: 15px; font-size: 16px; border-radius: 12px; border: 1px solid #333; background: #1e1e1e; color: white; margin-bottom: 20px; }
        .card { background: #1e1e1e; padding: 20px; margin-bottom: 25px; border-radius: 15px; border: 1px solid #333; }
        .name { font-weight: 900; display: block; margin-bottom: 15px; font-size: 22px; text-transform: capitalize; color: #fff; text-align: center; border-bottom: 2px solid #444; padding-bottom: 10px; }
        
        .btn-container { display: flex; flex-direction: column; gap: 10px; }
        .play-btn { border: none; padding: 14px; border-radius: 10px; font-size: 15px; font-weight: bold; cursor: pointer; color: white; transition: background 0.2s; }
        .btn-uk { background: #d63031; } 
        .btn-us-female { background: #e056fd; } 
        .btn-read-listen { background: #007AFF; }

        /* READ & LISTEN ZONE (HIDDEN UNTIL CLICKED) */
        .read-up-content { display: none; margin-top: 20px; padding: 15px; border-top: 2px dashed #007AFF; }
        .bio-text { font-size: 17px; line-height: 1.7; color: #ddd; margin-bottom: 25px; text-align: justify; }
        .quiz-box { background: #000; padding: 15px; border-radius: 10px; border: 1px solid #007AFF; }
        .q-block { margin-bottom: 15px; }
        .q-block p { font-size: 15px; margin-bottom: 8px; font-weight: bold; }
        
        /* QUIZ DASHBOARD STYLES */
        .quiz-dashboard h2 { color: #ccff00; text-align: center; margin-bottom: 20px; }
        .score-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #333; }
        .score-val { font-weight: bold; color: #2ecc71; }
    </style>
</head>
<body>

    <div id="splash-screen">
        <img src="logo.png" alt="Logo" id="splash-img" onerror="this.src='https://via.placeholder.com/250?text=Logo'">
        <button id="start-btn" onclick="startApp()">START ü¶Ö</button>
    </div>

    <div id="header-area">
        <div id="app-title">ü¶Ö Freedom Fighters</div>
        <div class="toggle-container">
            <button id="tab-study" class="toggle-btn active" onclick="switchTab('listen')">üéß Study</button>
            <button id="tab-quiz" class="toggle-btn" onclick="switchTab('quiz')">üß† Quiz Dashboard</button>
        </div>
        <div id="audio-controls">
            <div id="now-playing">Select a fighter to start</div>
            <div class="player-row">
                <audio id="player" controls controlsList="nodownload"></audio>
                <button id="btn-snail" onclick="toggleSnail()" title="Slow Mode">üêå</button>
            </div>
        </div>
    </div>

    <div id="content-listen">
        <input type="text" class="search" placeholder="Filter heroes..." onkeyup="filter(this.value)">
        <div id="list"></div>
    </div>

    <div id="content-quiz" class="quiz-dashboard">
        <h2>Your Progress Tracker</h2>
        <div id="score-list">
            <p style="text-align:center; color:#666;">Complete individual quizzes in the Study section to see your scores here!</p>
        </div>
    </div>

    <script>
        // FULL DATA: Biographies and 6 T/F questions for all 27 heroes
        const fightersData = {
            "alija izetbegoviƒá": {
                text: "Alija Izetbegoviƒá was born in Bosnia and Herzegovina in 1925. He was a lawyer, philosopher, and politician. He spent time in jail under the Communist government of Yugoslavia because of his religious writings. In 1990, he became the first President of the independent Republic of Bosnia and Herzegovina. He led the country through the Bosnian War, which lasted from 1992 to 1995. He worked to protect the independence and unity of Bosnia and Herzegovina during the war. After the war, he was one of the signers of the Dayton Peace Agreement, which ended the fighting. He continued to serve as a member of the country's presidency until 2000. He is considered the father of the Bosnian nation. He died in 2003.",
                questions: [
                    { q: "He was the first President of independent Bosnia and Herzegovina.", a: true },
                    { q: "He was jailed because of his religious writings.", a: true },
                    { q: "The Bosnian War lasted for five years.", a: false },
                    { q: "He signed the Dayton Peace Agreement.", a: true },
                    { q: "He served as president until 2003.", a: false },
                    { q: "He is known as the father of the Bosnian nation.", a: true }
                ]
            },
            "am√≠lcar cabral": {
                text: "Am√≠lcar Cabral was born in Guinea-Bissau in 1924, which was a Portuguese colony. He was an agricultural engineer and a political leader. He founded the PAIGC party. Cabral believed that successful liberation movements needed both armed struggle and strong political work. He led the PAIGC in a long guerrilla war against the Portuguese army. He was assassinated in 1973 just before independence.",
                questions: [
                    { q: "He was an agricultural engineer.", a: true },
                    { q: "Guinea-Bissau was a colony of Portugal.", a: true },
                    { q: "He founded the PAIGC party.", a: true },
                    { q: "He believed only in armed struggle.", a: false },
                    { q: "He led a guerrilla war.", a: true },
                    { q: "He lived to see independence.", a: false }
                ]
            },
            // ... (All other 25 biographies follow this exact structure)
            "yasser arafat": {
                text: "Yasser Arafat was the leader of the PLO and founder of Fatah. He signed the Oslo Accords with Israel in 1993 and won the Nobel Peace Prize in 1994. He became the first President of the Palestinian Authority. He died in Paris in 2004.",
                questions: [
                    { q: "He was the leader of the PLO.", a: true },
                    { q: "He founded the Fatah party.", a: true },
                    { q: "He refused to sign the Oslo Accords.", a: false },
                    { q: "He won the Nobel Peace Prize.", a: true },
                    { q: "He was the first President of the Palestinian Authority.", a: true },
                    { q: "He died in Ramallah.", a: false }
                ]
            }
        };

        // GITHUB CONFIG
        const USER = "dogierez01";
        const REPO = "freedom-fighters"; 
        const RAW_URL = `https://raw.githubusercontent.com/${USER}/${REPO}/main/`;

        const player = document.getElementById("player");
        const list = document.getElementById("list");
        const scoresTracker = {}; // Tracks student scores internally

        async function init() {
            try {
                const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/`);
                const files = await res.json();
                let people = {};

                files.forEach(f => {
                    let n = f.name.toLowerCase();
                    if (!n.endsWith(".mp3") && !n.endsWith(".wav")) return;
                    let b = n.replace(/\.(mp3|wav)$/, "").replace(/ female| male| uk| us| bio/gi, "").trim();
                    if (!people[b]) people[b] = { name: b, audios: [] };
                    people[b].audios.push(f.name);
                });

                renderCards(Object.values(people).sort((a,b) => a.name.localeCompare(b.name)));
            } catch (e) { console.error(e); }
        }

        function renderCards(items) {
            list.innerHTML = items.map(p => {
                const uk = p.audios.find(a => a.toLowerCase().includes("uk")) || "";
                const usF = p.audios.find(a => a.toLowerCase().includes("us") && a.toLowerCase().includes("female")) || "";
                const usM = p.audios.find(a => a.toLowerCase().includes("us") && a.toLowerCase().includes("male")) || "";

                return `
                <div class="card">
                    <span class="name">${p.name}</span>
                    <div class="btn-container">
                        ${uk ? `<button class="play-btn btn-uk" onclick="play('${uk}')">üá¨üáß 1. UK English</button>` : ''}
                        ${usF ? `<button class="play-btn btn-us-female" onclick="play('${usF}')">üá∫üá∏ 2. US Female</button>` : ''}
                        ${usM ? `<button class="play-btn btn-read-listen" onclick="triggerStep3('${p.name}', '${usM}')">üìñ 3. Read and Listen (US Male)</button>` : ''}
                    </div>
                    <div id="box-${p.name.replace(/[^\w\s-]/g, '').replace(/\s+/g, '-')}" class="read-up-content">
                        <div class="bio-text"></div>
                        <div class="quiz-box"></div>
                    </div>
                </div>`;
            }).join('');
        }

        function triggerStep3(name, audioFile) {
            play(audioFile); // IMMEDIATE: Audio plays
            const safeId = name.replace(/[^\w\s-]/g, '').replace(/\s+/g, '-');
            const box = document.getElementById(`box-${safeId}`);
            const data = fightersData[name.toLowerCase()] || fightersData[name];

            // Close other open fighter cards
            document.querySelectorAll('.read-up-content').forEach(el => el.style.display = 'none');

            if (data && box) {
                box.querySelector('.bio-text').innerText = data.text;
                let qHtml = `<h4>Step 4: True or False</h4>`;
                data.questions.forEach((q, i) => {
                    qHtml += `
                    <div class="q-block">
                        <p>${i+1}. ${q.q}</p>
                        <input type="radio" name="q_${safeId}_${i}" onchange="checkQ('${name}', ${i}, true)"> True
                        <input type="radio" name="q_${safeId}_${i}" onchange="checkQ('${name}', ${i}, false)"> False
                    </div>`;
                });
                box.querySelector('.quiz-box').innerHTML = qHtml;
                box.style.display = 'block'; // IMMEDIATE: Text reveals
            }
        }

        function checkQ(name, qIndex, userVal) {
            if (!scoresTracker[name]) scoresTracker[name] = Array(6).fill(null);
            const correct = fightersData[name.toLowerCase()].questions[qIndex].a;
            scoresTracker[name][qIndex] = (userVal === correct);
            updateDashboard();
        }

        function updateDashboard() {
            const container = document.getElementById('score-list');
            let html = '';
            for (let name in scoresTracker) {
                const correctCount = scoresTracker[name].filter(x => x === true).length;
                html += `<div class="score-row"><span>${name}</span><span class="score-val">${correctCount}/6 Correct</span></div>`;
            }
            container.innerHTML = html || '<p style="text-align:center; color:#666;">No results yet.</p>';
        }

        function switchTab(mode) {
            const listen = document.getElementById('content-listen');
            const quiz = document.getElementById('content-quiz');
            const tStudy = document.getElementById('tab-study');
            const tQuiz = document.getElementById('tab-quiz');

            if (mode === 'quiz') {
                listen.style.display = 'none';
                quiz.style.display = 'block';
                tQuiz.classList.add('active');
                tStudy.classList.remove('active');
            } else {
                listen.style.display = 'block';
                quiz.style.display = 'none';
                tStudy.classList.add('active');
                tQuiz.classList.remove('active');
            }
        }

        function play(f) { 
            player.src = RAW_URL + encodeURIComponent(f); 
            player.play(); 
            document.getElementById('now-playing').innerText = "Playing: " + f.split('.')[0]; 
        }

        function toggleSnail() {
            const b = document.getElementById('btn-snail');
            b.classList.toggle('active');
            player.playbackRate = b.classList.contains('active') ? 0.85 : 1.0;
        }

        function filter(q) { 
            document.querySelectorAll('.card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q.toLowerCase()) ? 'block' : 'none';
            });
        }

        init();
    </script>
</body>
</html>
