<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Freedom Fighters</title>
    
    <script>
        function startApp() {
            const splash = document.getElementById('splash-screen');
            if(splash) {
                splash.style.opacity = '0';
                setTimeout(() => { splash.style.display = 'none'; }, 500);
            }
        }
    </script>

    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #e0e0e0; margin: 0; padding: 0; overflow-x: hidden; }

        /* SPLASH SCREEN - LOGO WITH NEON YELLOW RING */
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease-out; }
        #splash-img { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; margin-bottom: 30px; border: 8px solid #ccff00; box-shadow: 0 0 20px #ccff00, 0 0 40px #ccff00; }
        #start-btn { padding: 15px 60px; font-size: 22px; font-weight: 900; color: white; background: linear-gradient(135deg, #2f9e44, #2ecc71); border: none; border-radius: 50px; cursor: pointer; text-transform: uppercase; }

        /* HEADER AREA */
        #header-area { position: fixed; top: 0; left: 0; width: 100%; background: #000; border-bottom: 2px solid #333; z-index: 2000; display: flex; flex-direction: column; align-items: center; padding-bottom: 10px; }
        #app-title { color: #fff; font-size: 16px; font-weight: 900; margin: 10px 0; letter-spacing: 1px; text-transform: uppercase; }

        .toggle-container { display: flex; background: #1e1e1e; border-radius: 30px; padding: 4px; border: 1px solid #333; margin-bottom: 5px;}
        .toggle-btn { padding: 8px 24px; border-radius: 25px; border: none; font-size: 13px; font-weight: bold; cursor: pointer; color: #888; background: transparent; }
        .toggle-btn.active { color: #fff; background: #007AFF; }

        /* PLAYER */
        #audio-controls { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 5px; }
        #now-playing { color: #4dabf7; font-size: 12px; margin-bottom: 5px; font-weight: bold; height: 15px; }
        .player-row { display: flex; align-items: center; justify-content: center; gap: 10px; width: 95%; max-width: 600px; }
        #player { flex-grow: 1; height: 45px; }
        #btn-snail { min-width: 60px; height: 45px; background: #111; border: 2px solid #ff0033; border-radius: 10px; font-size: 25px; cursor: pointer; }
        #btn-snail.active { border-color: #39ff14; box-shadow: 0 0 10px #39ff14; }

        /* CONTENT ZONES */
        #content-listen { padding: 20px; padding-top: 175px; max-width: 650px; margin: 0 auto; display: block; }
        #content-quiz { padding: 20px; padding-top: 175px; max-width: 650px; margin: 0 auto; display: none; }

        /* LIST CARDS */
        .search { width: 100%; padding: 15px; font-size: 16px; border-radius: 12px; border: 1px solid #333; background: #1e1e1e; color: white; margin-bottom: 20px; }
        .card { background: #1e1e1e; padding: 20px; margin-bottom: 25px; border-radius: 15px; border: 1px solid #333; }
        .name { font-weight: 900; display: block; margin-bottom: 15px; font-size: 22px; text-transform: capitalize; color: #fff; text-align: center; border-bottom: 2px solid #444; padding-bottom: 10px; }
        
        .btn-container { display: flex; flex-direction: column; gap: 10px; }
        .play-btn { border: none; padding: 14px; border-radius: 10px; font-size: 15px; font-weight: bold; cursor: pointer; color: white; }
        .btn-uk { background: #d63031; } 
        .btn-us-female { background: #e056fd; } 
        .btn-read-listen { background: #007AFF; }

        /* FULL WINDOW TEXT OVERLAY */
        #text-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 3000; padding: 40px; box-sizing: border-box; overflow-y: auto; }
        .overlay-close { position: fixed; top: 20px; right: 20px; background: #ff0033; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; z-index: 3001; }
        #overlay-text { font-size: 24px; line-height: 1.6; color: #e0e0e0; max-width: 800px; margin: 60px auto; text-align: justify; }

        /* QUIZ TAB STYLES */
        .quiz-menu-btn { width: 100%; padding: 15px; background: #1e1e1e; border: 1px solid #333; color: white; font-weight: bold; border-radius: 10px; margin-bottom: 10px; cursor: pointer; text-align: left; font-size: 18px; text-transform: capitalize; }
        .quiz-display { display: none; background: #000; padding: 20px; border-radius: 15px; border: 2px solid #007AFF; margin-top: 20px; }
        .q-block { margin-bottom: 20px; border-bottom: 1px solid #222; padding-bottom: 10px; }
        .q-block p { font-size: 18px; font-weight: bold; color: #4dabf7; margin-bottom: 10px; }
        .feedback { font-weight: bold; display: block; margin-top: 5px; }
        .feedback.correct { color: #2ecc71; }
        .feedback.wrong { color: #ff0033; }
        label { margin-right: 25px; cursor: pointer; font-size: 17px; }
    </style>
</head>
<body>

    <div id="splash-screen">
        <img src="logo.png" alt="Logo" id="splash-img" onerror="this.src='https://via.placeholder.com/250?text=Logo'">
        <button id="start-btn" onclick="startApp()">START ü¶Ö</button>
    </div>

    <div id="header-area">
        <div id="app-title">ü¶Ö Freedom Fighters</div>
        <div class="toggle-container">
            <button id="tab-listen" class="toggle-btn active" onclick="switchTab('listen')">üéß Listen</button>
            <button id="tab-quiz" class="toggle-btn" onclick="switchTab('quiz')">üß† Quiz</button>
        </div>
        <div id="audio-controls">
            <div id="now-playing"></div>
            <div class="player-row">
                <audio id="player" controls controlsList="nodownload"></audio>
                <button id="btn-snail" onclick="toggleSnail()">üêå</button>
            </div>
        </div>
    </div>

    <div id="content-listen">
        <div id="listen-list"></div>
    </div>

    <div id="content-quiz">
        <div id="quiz-menu"></div>
        <div id="active-quiz-container" class="quiz-display">
            <button onclick="backToQuizMenu()" style="background:#444; color:white; border:none; padding:8px 15px; border-radius:5px; margin-bottom:15px; cursor:pointer;">&larr; Back to List</button>
            <h2 id="quiz-title" style="text-align:center; color:#fff; text-transform:capitalize;"></h2>
            <div id="quiz-questions"></div>
        </div>
    </div>

    <div id="text-overlay">
        <button class="overlay-close" onclick="closeOverlay()">Close Reading</button>
        <div id="overlay-text"></div>
    </div>

    <script>
        const fightersData = {
            "alija izetbegoviƒá": {
                text: "Alija Izetbegoviƒá was born in Bosnia and Herzegovina in 1925. He was a lawyer, philosopher, and politician. He spent time in jail under the Communist government of Yugoslavia because of his religious writings. In 1990, he became the first President of the independent Republic of Bosnia and Herzegovina. He led the country through the Bosnian War, which lasted from 1992 to 1995. He worked to protect the independence and unity of Bosnia and Herzegovina during the war. After the war, he was one of the signers of the Dayton Peace Agreement, which ended the fighting. He continued to serve as a member of the country's presidency until 2000. He is considered the father of the Bosnian nation. He died in 2003.",
                questions: [
                    {q: "He was the first President of independent Bosnia and Herzegovina.", a: true},
                    {q: "He was jailed because of his religious writings.", a: true},
                    {q: "The Bosnian War lasted for five years.", a: false},
                    {q: "He helped sign the Dayton Peace Agreement.", a: true},
                    {q: "He served as president until 2003.", a: false},
                    {q: "He is known as the father of the Bosnian nation.", a: true}
                ]
            },
            "am√≠lcar cabral": {
                text: "Am√≠lcar Cabral was born in Guinea-Bissau in 1924, which was a Portuguese colony. He was an agricultural engineer and a political leader. He founded the African Party for the Independence of Guinea and Cape Verde (PAIGC). This party fought to gain independence for both countries from Portugal. Cabral was a brilliant thinker and a skilled organizer. He believed that successful liberation movements needed both armed struggle and strong political work among the people. His ideas about culture and national identity were important to many anti-colonial movements. He led the PAIGC in a long and successful guerrilla war against the Portuguese army. Tragically, he was assassinated in 1973 by a rival faction within his own movement, just before Guinea-Bissau won independence.",
                questions: [
                    {q: "Am√≠lcar Cabral was an agricultural engineer.", a: true},
                    {q: "Guinea-Bissau was a colony of Spain.", a: false},
                    {q: "He founded the PAIGC party.", a: true},
                    {q: "He believed in combining armed struggle with political work.", a: true},
                    {q: "He led a guerrilla war against the Portuguese army.", a: true},
                    {q: "He was assassinated after independence was won.", a: false}
                ]
            }
            // ... (All other biographies follow this pattern)
        };

        const USER = "dogierez01";
        const REPO = "freedom-fighters";
        const RAW_URL = `https://raw.githubusercontent.com/${USER}/${REPO}/main/`;
        const player = document.getElementById("player");

        async function init() {
            try {
                const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/`);
                const files = await res.json();
                let people = {};

                files.forEach(f => {
                    let n = f.name.toLowerCase();
                    if (!n.endsWith(".mp3") && !n.endsWith(".wav")) return;
                    let base = n.replace(/\.(mp3|wav)$/, "").replace(/ female| male| uk| us| bio/gi, "").trim();
                    if (!people[base]) people[base] = { name: base, audios: [] };
                    people[base].audios.push(f.name);
                });

                const sorted = Object.values(people).sort((a,b) => a.name.localeCompare(b.name));
                renderListen(sorted);
                renderQuizList(sorted);
            } catch (e) { console.error(e); }
        }

        function renderListen(items) {
            document.getElementById("listen-list").innerHTML = items.map(p => {
                const uk = p.audios.find(a => a.toLowerCase().includes("uk")) || "";
                // STRICT ASSIGNMENT
                const usF = p.audios.find(a => a.toLowerCase().includes("us") && a.toLowerCase().includes("female")) || "";
                const usM = p.audios.find(a => a.toLowerCase().includes("us") && a.toLowerCase().includes("male")) || "";

                return `
                <div class="card">
                    <span class="name">${p.name}</span>
                    <div class="btn-container">
                        <button class="play-btn btn-uk" onclick="play('${uk}')">üá¨üáß 1. UK English</button>
                        <button class="play-btn btn-us-female" onclick="play('${usF}')">üá∫üá∏ 2. US Female</button>
                        <button class="play-btn btn-read-listen" onclick="triggerFullRead('${p.name}', '${usM}')">üìñ 3. Read and Listen (US Male)</button>
                    </div>
                </div>`;
            }).join('');
        }

        function triggerFullRead(name, audioFile) {
            play(audioFile); // Play US Male instantly
            const key = Object.keys(fightersData).find(k => 
                k.normalize("NFD").replace(/[\u0300-\u036f]/g, "") === name.normalize("NFD").replace(/[\u0300-\u036f]/g, "")
            );
            const data = fightersData[key];
            if (data) {
                document.getElementById('overlay-text').innerText = data.text;
                document.getElementById('text-overlay').style.display = 'block'; // Full window open
            }
        }

        function closeOverlay() { document.getElementById('text-overlay').style.display = 'none'; }

        function renderQuizList(items) {
            document.getElementById("quiz-menu").innerHTML = items.map(p => `
                <button class="quiz-menu-btn" onclick="openQuiz('${p.name}')">${p.name}</button>
            `).join('');
        }

        function openQuiz(name) {
            const questionsDiv = document.getElementById('quiz-questions');
            document.getElementById('quiz-title').innerText = name;
            const key = Object.keys(fightersData).find(k => 
                k.normalize("NFD").replace(/[\u0300-\u036f]/g, "") === name.normalize("NFD").replace(/[\u0300-\u036f]/g, "")
            );
            const data = fightersData[key];

            if (data) {
                let qHtml = "";
                data.questions.forEach((q, i) => {
                    qHtml += `
                    <div class="q-block">
                        <p>${i+1}. ${q.q}</p>
                        <label><input type="radio" name="qz_${i}" onclick="checkAnswer(this, ${q.a})"> True</label>
                        <label><input type="radio" name="qz_${i}" onclick="checkAnswer(this, ${!q.a})"> False</label>
                        <span id="feedback_${i}" class="feedback"></span>
                    </div>`;
                });
                questionsDiv.innerHTML = qHtml;
                document.getElementById('quiz-menu').style.display = 'none';
                document.getElementById('active-quiz-container').style.display = 'block';
            }
        }

        function checkAnswer(el, isCorrect) {
            const feedbackId = el.name.replace('qz_', 'feedback_');
            const feedbackEl = document.getElementById(feedbackId);
            feedbackEl.innerText = isCorrect ? "‚úì Correct" : "‚úó Wrong";
            feedbackEl.className = "feedback " + (isCorrect ? "correct" : "wrong");
        }

        function backToQuizMenu() {
            document.getElementById('active-quiz-container').style.display = 'none';
            document.getElementById('quiz-menu').style.display = 'block';
        }

        function switchTab(mode) {
            document.getElementById('content-listen').style.display = mode === 'listen' ? 'block' : 'none';
            document.getElementById('content-quiz').style.display = mode === 'quiz' ? 'block' : 'none';
            document.getElementById('tab-listen').classList.toggle('active', mode === 'listen');
            document.getElementById('tab-quiz').classList.toggle('active', mode === 'quiz');
            if (mode === 'quiz') backToQuizMenu();
        }

        function play(f) { 
            player.src = RAW_URL + encodeURIComponent(f); 
            player.play(); 
            document.getElementById('now-playing').innerText = "Playing: " + f.split('.')[0]; 
        }

        function toggleSnail() {
            const b = document.getElementById('btn-snail');
            b.classList.toggle('active');
            player.playbackRate = b.classList.contains('active') ? 0.85 : 1.0;
        }

        init();
    </script>
</body>
</html>
